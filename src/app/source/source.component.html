<h1>{{ source().abbr?.value ?? source().xref }}</h1>

<h2>Title</h2>
<div>{{ source().title?.value }}</div>

<h2>Text</h2>
<div>{{ source().text?.value }}</div>

<h2>Repositories</h2>
<dl>
    <ng-container *ngFor="let repositoryCitation of source().repositories">
        <dt>
            <a routerLink="/repository/{{repositoryCitation.repositoryXref}}">
                {{ancestryService.repository(repositoryCitation.repositoryXref).name}}
            </a>
        </dt>
        <dd *ngFor="let callNumber of repositoryCitation.callNumbers">
            <a *ngIf="callNumber.startsWith('http')" href={{callNumber}}>{{callNumber}}</a>
        </dd>
    </ng-container>
</dl>

<h2>Citations</h2>
<table class="table table-striped">
    <thead>
        <tr>
            <th scope="col">Individual</th>
            <th scope="col">Event</th>
            <th scope="col">Citation</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let ref of source().citations()">
            <td><a routerLink="/individual/{{ ref.individual.xref }}">{{ ref.individual.name }}</a></td>
            <td>{{ ref.event.type }}</td>
            <td>
                <pre>{{ ref.citation.text }}</pre>
            </td>
        </tr>
    </tbody>
</table>

@if (source().unknowns.length > 0) {
<h2>Unknown Records</h2>
<pre *ngFor="let unknown of source().unknowns">{{ unknown.gedcomRecord().text().join('\n') }}</pre>
}

<h2>gedcom</h2>
<pre>{{ source().gedcomRecord().text().join('\n') }}</pre>

<h2>Edit</h2>
<form [formGroup]="sourceForm" (ngSubmit)="onSubmit()">
    <h3>Abbr</h3>
    <textarea formControlName="abbr">{{ source().abbr?.value }}</textarea>
    <h3>Title</h3>
    <textarea formControlName="title">{{ source().title?.value }}</textarea>
    <h3>Text</h3>
    <textarea formControlName="text">{{ source().text?.value }}</textarea>
    <input type="submit">
</form>